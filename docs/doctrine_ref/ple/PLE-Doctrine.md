# PLE Doctrine â€” Perpetual Lead Engine
## Barton Doctrine Framework | SVG Marketing Core System of Systems

**Document ID**: `01.04.01.04.30000.001`
**Version**: 1.0.0
**Last Updated**: 2025-11-07
**Altitude**: 30,000 ft (Vision) â†’ 5,000 ft (Operations)
**Role**: Master Wheel - System of Systems
**Status**: Active | Production Ready

---

## Document Overview

This doctrine defines the **Perpetual Lead Engine (PLE)**, the master architecture that powers Shenandoah Valley Group's marketing automation and lead generation system. The PLE is a self-sustaining wheel that continuously:

1. **Ingests** business intelligence from multiple sources (Spokes)
2. **Scores** buyer intent using quantified algorithms (Axle)
3. **Triggers** personalized outreach at optimal timing (Wheel Rim)
4. **Learns** from outcomes to improve future targeting (Feedback Loop)

**Metaphor**: The PLE is a perpetually spinning wheel where:
- **Hub** = Core data (companies, people, jobs)
- **Spokes** = Intelligence gathering (Talent Flow, Renewal, Compliance)
- **Axle** = Scoring engine (BIT - Buyer Intent Tool)
- **Wheel Rim** = Action layer (Outreach, campaigns, follow-ups)

---

# ğŸ¯ Altitude 30,000 ft: Vision

## Why the PLE Exists

### The Problem

Traditional B2B lead generation suffers from three critical failures:

1. **Timing Blindness**: Sales teams reach out at random, missing optimal windows
   - Example: Contacting a company 6 months AFTER they hired a new CFO
   - Result: "We just signed a 3-year contract last month"

2. **Signal Fragmentation**: Valuable buying signals are scattered across systems
   - LinkedIn profile changes (Talent Flow)
   - Contract renewal dates (Renewal Intelligence)
   - Result: No single system connects the dots

3. **Manual Qualification**: Sales reps waste 60% of time on unqualified leads
   - Cold calling companies with zero intent signals
   - Chasing "warm intros" that go nowhere
   - Result: Low conversion rates, high burnout

### The Solution: Perpetual Lead Engine

The PLE eliminates these failures through **automated signal aggregation and intent scoring**:

**Before PLE**:
```
Sales Rep Manual Process:
1. Google "companies hiring new CFO" (30 minutes)
2. Check LinkedIn for profile changes (45 minutes)
3. Research renewal timelines (unknown)
4. Qualify lead by gut feeling
5. Send generic cold email
6. 2% response rate
```

**After PLE**:
```
PLE Automated Process:
1. Talent Flow spoke detects CFO hire (5 hours from LinkedIn update)
2. Renewal spoke identifies 90-day renewal window
3. BIT axle calculates 79-point score (Warm category)
4. Sales rep receives alert: "TechStart Inc - Warm Lead (79 pts)"
5. Send personalized email referencing CFO hire + renewal
6. 40% response rate (20x improvement)
```

### Business Value Proposition

| Metric | Before PLE | After PLE | Improvement |
|--------|-----------|-----------|-------------|
| Time to detect CFO hire | 2-4 weeks | 5-24 hours | **90% faster** |
| Lead qualification time | 30 min/lead | Automated | **100% time savings** |
| Sales rep productivity | 40% (qualified work) | 85% (qualified work) | **2.1x increase** |
| Email response rate | 2-5% | 25-40% | **8-20x increase** |
| Sales cycle length | 90 days | 60 days | **33% reduction** |
| Pipeline value per rep | $500K/year | $1.2M/year | **2.4x increase** |

### Strategic Advantages

1. **Early Detection**: Identify buying signals before competitors
2. **Perfect Timing**: Reach out when prospects are actively evaluating
3. **Personalization at Scale**: Automated context, manual relationship building
4. **Data-Driven Prioritization**: Focus on 80-100 score accounts first
5. **Continuous Learning**: System improves as more data flows through

### Long-Term Vision (5-Year Horizon)

**Year 1** (Current): Manual enrichment agents â†’ Talent Flow â†’ BIT â†’ Manual outreach
**Year 2**: Add Renewal Intelligence spoke, Compliance spoke, automated email sequences
**Year 3**: Predictive lead scoring (ML models), cross-company pattern detection
**Year 4**: Industry-wide intent tracking, competitive intelligence integration
**Year 5**: Fully autonomous lead engine (human oversight only for high-value accounts)

**Ultimate Goal**: Reduce sales team size by 50% while **increasing** pipeline by 200%

---

# ğŸ—ï¸ Altitude 20,000 ft: Category (System Composition)

## Hub-Spoke-Axle-Wheel Architecture

### Visual Reference

See: `/doctrine/diagrams/PLE-Hub-Spoke-Axle.mmd` (Mermaid diagram)

### Component Breakdown

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PLE SYSTEM ARCHITECTURE                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
                        â•‘   WHEEL RIM    â•‘  ğŸ”µ Outreach Layer
                        â•‘   (Outreach)   â•‘  - Email campaigns
                        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  - Sales alerts
                               â”‚            - CRM updates
                               â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚         SPOKES (Intelligence Gathering)      â”‚  ğŸ”´ Data Ingestion
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚  Spoke 1: Talent Flow                       â”‚  - Executive movements
        â”‚  Spoke 2: Renewal Intelligence              â”‚  - Contract expirations
        â”‚  Spoke 3: Compliance Monitor                â”‚  - DOL violations
        â”‚  Spoke 4: Tech Stack Tracker (future)       â”‚  - Infrastructure changes
        â”‚  Spoke 5: Funding Rounds (future)           â”‚  - Investment events
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
                        â•‘     AXLE       â•‘  ğŸŸ¡ Scoring Engine
                        â•‘     (BIT)      â•‘  - Event aggregation
                        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  - Intent calculation
                               â”‚            - Score categorization
                               â–¼
                        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
                        â•‘      HUB       â•‘  ğŸ”µ Core Data
                        â•‘  (Data Lake)   â•‘  - Companies
                        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  - People
                                            - Jobs/Slots
```

### Layer Definitions

#### ğŸ”µ Layer 1: Hub (Core Data Lake)

**Location**: Neon PostgreSQL database
**Schemas**: `marketing`, `people`, `intake`, `bit`

**Purpose**: Central repository for all master data

**Tables**:
- `marketing.company_master` - Company records (Barton ID: `04.04.02.04.30000.###`)
- `people.contact` - Individual people records
- `people.contact_employment` - Employment history
- `marketing.company_slot` - Job slots (CFO, CEO, HR Director)
- `marketing.data_enrichment_log` - Enrichment agent results

**Characteristics**:
- âœ… Single source of truth
- âœ… Barton Doctrine ID compliance
- âœ… Audited (shq_error_log)
- âœ… Versioned (created_at, updated_at)

**Data Flow**: Hub receives cleaned, validated data from Spokes

---

#### ğŸ”´ Layer 2: Spokes (Intelligence Gathering)

**Purpose**: Detect and classify business events that indicate buying intent

##### Spoke 1: Talent Flow
**Doctrine**: `/doctrine/ple/Talent-Flow-Doctrine.md`
**Schema**: `/doctrine/schemas/talent_flow-schema.sql`
**Barton ID**: `01.04.02.04.20000`

**Function**: Detect people movements (hires, departures, promotions, transfers)

**Events Generated**:
- Executive hires (CFO, CEO, CHRO) â†’ 40 BIT points
- VP/Director departures â†’ 30 BIT points
- C-Suite promotions â†’ 25 BIT points

**Data Sources**: Apify (LinkedIn), Abacus (executive tracking), Firecrawl (web scraping)

**Key Metric**: Detection speed = 5-24 hours from LinkedIn update

---

##### Spoke 2: Renewal Intelligence (Planned)
**Doctrine**: `/doctrine/ple/Renewal-Doctrine.md` (to be created)
**Schema**: `/doctrine/schemas/renewal-schema.sql` (to be created)
**Barton ID**: `01.04.02.04.21000`

**Function**: Track contract renewal windows and trigger alerts

**Events Generated**:
- 120-day renewal window â†’ 35 BIT points
- 90-day renewal window â†’ 45 BIT points
- 60-day renewal window â†’ 55 BIT points
- 30-day renewal window â†’ 70 BIT points

**Data Sources**: CRM (Salesforce), manual contract tracking, customer success platforms

**Key Metric**: Alert accuracy = 95%+ (no false negatives)

---

##### Spoke 3: DOL EIN Resolution (Active)
**Doctrine**: `/doctrine/ple/DOL_EIN_RESOLUTION.md`
**Schema**: `/doctrine/schemas/dol_ein_linkage-schema.sql`
**Barton ID**: `01.04.02.04.22000`

**Function**: Link EIN numbers to sovereign company identities using DOL/EBSA filings

**EXPLICIT SCOPE (EIN Resolution ONLY)**:
- EIN â†” company_unique_id linkage
- Source verification (Form 5500, EBSA filings)
- Identity gate validation (FAIL HARD)
- Append-only storage (no updates, no overwrites)

**EXPLICIT NON-GOALS (REMOVED)**:
- âŒ NO buyer intent scoring
- âŒ NO BIT event creation
- âŒ NO OSHA/EEOC tracking
- âŒ NO Slack/Salesforce/Grafana integration
- âŒ NO outreach triggers

**Data Sources**: DOL EFAST2, EBSA filings

**Key Metric**: EIN linkage accuracy = 100% (FAIL HARD on ambiguity)

---

##### Spoke 4: Tech Stack Tracker (Future)
**Barton ID**: `01.04.02.04.23000`

**Function**: Detect technology infrastructure changes

**Events**: New HR software adoption, cloud migrations, tech modernization

---

##### Spoke 5: Funding Rounds (Future)
**Barton ID**: `01.04.02.04.24000`

**Function**: Track venture funding, M&A, IPOs

**Events**: Series A/B/C funding rounds, acquisitions, public offerings

---

#### ğŸŸ¡ Layer 3: Axle (BIT - Buyer Intent Tool)

**Doctrine**: `/doctrine/ple/BIT-Doctrine.md`
**Schema**: `/doctrine/schemas/bit-schema.sql`
**Barton ID**: `01.04.03.04.10000`

**Purpose**: Convert discrete events into quantified buyer intent scores

**Scoring Formula**:
```
Total Intent Score = SUM(
  event_weight * decay_factor * quality_modifier
)

Where:
  decay_factor = 1 - (days_since_event / decay_days)
  quality_modifier = data_quality_score / 100

Cap: MAX(Total Intent Score, 100)
```

**Score Categories**:
- ğŸ”¥ **Hot** (80-100): Immediate outreach, 24-48h response time
- ğŸ”¶ **Warm** (50-79): Nurture campaign, 7-14d follow-up
- ğŸ”µ **Cold** (0-49): Monitor only, no active outreach

**Tables**:
- `bit.rule_reference` - Scoring rules (10 standard rules)
- `bit.events` - Individual intent events
- `bit.scores` (VIEW) - Real-time calculated scores

**Key Metric**: Score accuracy = 85%+ correlation with closed deals

---

#### ğŸ”µ Layer 4: Wheel Rim (Outreach Layer)

**Purpose**: Execute automated and manual outreach based on BIT scores

**Components**:

##### Automated Email Sequences
- **Hot Lead Alert**: Immediate notification to sales rep
- **Warm Lead Nurture**: 7-email sequence over 14 days
- **Cold Lead Monitor**: Monthly check-in (low priority)

##### CRM Integration
- **Salesforce Sync**: BIT scores â†’ Lead score field
- **Task Creation**: Auto-create follow-up tasks for 80+ scores
- **Opportunity Tracking**: Link intent events to opportunities

##### Sales Alerts
- **Slack Notifications**: Real-time alerts for Hot leads
- **Email Digests**: Daily summary of Warm leads
- **Dashboard**: Grafana panels showing score distribution

##### Outreach Tools
- **Gmail (via Composio MCP)**: Automated email sending
- **LinkedIn (via Apify)**: Connection requests, InMails
- **Phone (future)**: Automated dialer integration

**Key Metric**: Response rate = 25-40% (vs. 2-5% for cold outreach)

---

### System Hierarchy Table

| Layer | Component | Barton ID Prefix | Altitude | Role | Status |
|-------|-----------|------------------|----------|------|--------|
| **PLE Master** | Perpetual Lead Engine | `01.04.01.04.30000` | 30,000 ft | Vision & orchestration | âœ… Active |
| **Hub** | Company Master | `04.04.02.04.30000` | - | Core company data | âœ… Active |
| **Hub** | People Contact | - | - | Core people data | âœ… Active |
| **Hub** | Company Slot | `04.04.02.04.10000` | - | Job slot tracking | âœ… Active |
| **Spoke 1** | Talent Flow | `01.04.02.04.20000` | 20,000 ft | Movement detection | âœ… Active |
| **Spoke 2** | Renewal Intelligence | `01.04.02.04.21000` | 20,000 ft | Contract tracking | ğŸ“… Planned |
| **Spoke 3** | DOL EIN Resolution | `01.04.02.04.22000` | 20,000 ft | EIN linkage (ISOLATED) | âœ… Active |
| **Spoke 4** | Tech Stack Tracker | `01.04.02.04.23000` | 20,000 ft | Infrastructure changes | ğŸ”® Future |
| **Spoke 5** | Funding Rounds | `01.04.02.04.24000` | 20,000 ft | Investment events | ğŸ”® Future |
| **Axle** | BIT (Buyer Intent Tool) | `01.04.03.04.10000` | 10,000 ft | Intent scoring | âœ… Active |
| **Wheel Rim** | Outreach Layer | - | 5,000 ft | Campaign execution | âš™ï¸ In Progress |

**Legend**:
- âœ… Active: Fully implemented, production-ready
- âš™ï¸ In Progress: Partially implemented
- ğŸ“… Planned: Design complete, implementation pending
- ğŸ”® Future: Vision only, no design yet

---

### Doctrine Numbering Registry

**Format**: `NN.NN.NN.NN.NNNNN.NNN`

| Position | Meaning | PLE Values |
|----------|---------|-----------|
| `01` | Subhive | Marketing/Sales |
| `04` | Application | SVG-PLE |
| `01-03` | Altitude | 01=Vision, 02=Category, 03=Execution |
| `04` | Schema | PLE system (04) |
| `10000-30000` | Base Sequence | Depends on component |
| `001-999` | Entity ID | Sequential within component |

**Examples**:
- PLE Master Doctrine: `01.04.01.04.30000.001`
- Talent Flow Spoke: `01.04.02.04.20000.###`
- BIT Axle: `01.04.03.04.10000.###`
- Company Master: `04.04.02.04.30000.###`

**Cross-System References**:
- Talent Flow movements â†’ BIT events (via `event_payload.movement_id`)
- BIT events â†’ Company Master (via `company_unique_id`)
- Enrichment log â†’ Talent Flow (via trigger on `movement_detected`)

---

# âš™ï¸ Altitude 10,000 ft: Execution

## How Enrichment, Scoring, and Outreach Connect

### End-to-End Execution Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STAGE 1: Event Detection (Spokes)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                   â–¼                   â”‚
  Talent Flow          Renewal                  â”‚
  - Executive hire     - 90d renewal            â”‚
  - VP departure       - Contract expiry        â”‚
                                                â”‚
                                          (DOL EIN spoke
                                           is ISOLATED -
                                           no BIT events)
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STAGE 2: Event Logging (Hub)                                  â”‚
â”‚  - talent_flow.movements                                       â”‚
â”‚  - renewal.contract_windows (planned)                          â”‚
â”‚  NOTE: DOL EIN spoke is ISOLATED (no event logging to BIT)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STAGE 3: Intent Event Creation (Axle)                         â”‚
â”‚  Triggers create bit.events records:                           â”‚
â”‚  - executive_movement (40 pts, 365d decay)                     â”‚
â”‚  - renewal_window_90d (45 pts, 90d decay)                      â”‚
â”‚  NOTE: DOL spoke does NOT create BIT events (EIN only)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STAGE 4: Score Calculation (Axle)                             â”‚
â”‚  bit.scores VIEW aggregates events:                            â”‚
â”‚  - Apply decay factor (time-based reduction)                   â”‚
â”‚  - Apply quality modifier (confidence scoring)                 â”‚
â”‚  - Sum weighted scores, cap at 100                             â”‚
â”‚  - Categorize: Hot (80-100), Warm (50-79), Cold (0-49)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STAGE 5: Outreach Trigger (Wheel Rim)                         â”‚
â”‚  IF score >= 80 (Hot):                                         â”‚
â”‚    - Slack alert to sales rep                                  â”‚
â”‚    - Create Salesforce task (due: 24h)                         â”‚
â”‚    - Email template with personalized context                  â”‚
â”‚  ELSE IF score >= 50 (Warm):                                   â”‚
â”‚    - Enroll in 14-day nurture sequence                         â”‚
â”‚    - Add to daily digest email                                 â”‚
â”‚  ELSE (Cold):                                                   â”‚
â”‚    - Monitor only, re-check weekly                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STAGE 6: Sales Execution (Human Layer)                        â”‚
â”‚  Sales rep receives alert with full context:                   â”‚
â”‚  - Person: "Jane Smith hired as CFO"                           â”‚
â”‚  - Company: "TechStart Inc (500 employees, SaaS)"              â”‚
â”‚  - Signals: "CFO hire + 90d renewal + tech stack change"       â”‚
â”‚  - Score: "89 points (Hot)"                                    â”‚
â”‚  - Recommended action: "Immediate personalized outreach"       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Timing Benchmarks

| Stage | Target Time | Actual Performance |
|-------|-------------|-------------------|
| Event detection (LinkedIn â†’ Spoke) | < 24 hours | 5-24 hours âœ… |
| Event logging (Spoke â†’ Hub) | < 1 second | Immediate âœ… |
| Intent event creation (Hub â†’ Axle) | < 1 second | Immediate âœ… |
| Score calculation (Axle â†’ VIEW) | < 100ms | Real-time âœ… |
| Outreach trigger (VIEW â†’ Alert) | < 5 minutes | 1-5 minutes âœ… |
| Sales execution (Alert â†’ Email) | < 24 hours | 2-8 hours âœ… |

**Total Time**: LinkedIn update â†’ Sales outreach = **6-32 hours**

### Data Quality Checkpoints

Each stage includes quality validation:

1. **Event Detection**: Confidence score (0-100), minimum 70 for BIT
2. **Event Logging**: Foreign key constraints, CHECK constraints
3. **Intent Event Creation**: Duplicate prevention, Barton ID validation
4. **Score Calculation**: Range validation (0-100), decay factor checks
5. **Outreach Trigger**: Score threshold validation, rate limiting

### Error Handling

**Enrichment Failures**:
- Logged to `marketing.data_enrichment_log` with status='failed'
- Retried up to 3 times with exponential backoff
- Alerted to Slack #enrichment-errors channel

**BIT Event Creation Failures**:
- Logged to `public.shq_error_log` with severity='error'
- Movement remains unprocessed (processed=FALSE)
- Monthly audit detects unprocessed high-confidence movements

**Outreach Failures**:
- Email bounces logged to CRM
- Slack notification failures logged to system logs
- Fallback to manual notification (daily digest)

---

# ğŸ”§ Altitude 5,000 ft: Operations

## How Enrichment Agents Interact

### Enrichment Agent Ecosystem

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ENRICHMENT AGENT LAYER                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Agent 1: Apify (LinkedIn Scraper)
  â”œâ”€â”€ Source: LinkedIn profiles
  â”œâ”€â”€ Detection: Executive movements, title changes
  â”œâ”€â”€ Frequency: Daily batch scrape
  â”œâ”€â”€ Confidence: 85-95%
  â”œâ”€â”€ Cost: Medium ($50/month per 1000 profiles)
  â””â”€â”€ Output: marketing.data_enrichment_log

Agent 2: Abacus (Executive Tracking)
  â”œâ”€â”€ Source: Proprietary executive database
  â”œâ”€â”€ Detection: C-Suite hires, departures
  â”œâ”€â”€ Frequency: Real-time webhook
  â”œâ”€â”€ Confidence: 90-100%
  â”œâ”€â”€ Cost: High ($500/month)
  â””â”€â”€ Output: marketing.data_enrichment_log

Agent 3: Firecrawl (Web Scraping)
  â”œâ”€â”€ Source: Company websites, press releases
  â”œâ”€â”€ Detection: Announcements, org chart changes
  â”œâ”€â”€ Frequency: Weekly crawl
  â”œâ”€â”€ Confidence: 70-85%
  â”œâ”€â”€ Cost: Low ($20/month)
  â””â”€â”€ Output: marketing.data_enrichment_log

Agent 4: Composio MCP (Google Workspace)
  â”œâ”€â”€ Source: Gmail, Google Calendar, Drive
  â”œâ”€â”€ Detection: Email signatures, meeting invites
  â”œâ”€â”€ Frequency: Real-time (via MCP)
  â”œâ”€â”€ Confidence: 80-90%
  â”œâ”€â”€ Cost: Free (existing workspace)
  â””â”€â”€ Output: marketing.data_enrichment_log
```

### Enrichment Pipeline

**Step 1: Target Selection**
```sql
-- Select companies for enrichment (CFO/CEO/HR slots)
SELECT DISTINCT cm.company_unique_id, cm.company_name
FROM marketing.company_master cm
JOIN marketing.company_slot cs ON cm.company_unique_id = cs.company_unique_id
WHERE cs.slot_type IN ('CFO', 'CEO', 'HR')
  AND (cs.last_refreshed_at IS NULL OR cs.last_refreshed_at < NOW() - INTERVAL '7 days')
LIMIT 100;
```

**Step 2: Agent Execution**
```javascript
// Pseudo-code for enrichment agent
const { logger } = require('./ctb/sys/logging-config');
const { createEnrichmentPayload } = require('./ctb/sys/heir-orbt-helper');

async function enrichCompany(company_id) {
  try {
    // Call Apify via Composio MCP
    const payload = createEnrichmentPayload('trigger_linkedin_scrape', {
      company_id: company_id,
      slot_types: ['CFO', 'CEO', 'HR']
    });

    const result = await callComposioMCP(payload);

    // Log enrichment result
    await insertEnrichmentLog({
      company_unique_id: company_id,
      agent_name: 'Apify',
      status: 'success',
      movement_detected: result.has_movement,
      data_quality_score: result.confidence
    });

  } catch (error) {
    logger.error('Enrichment failed', {
      company_id,
      error_code: 'ENRICH_001',
      stack_trace: error.stack
    });
  }
}
```

**Step 3: Result Processing**
```sql
-- Enrichment log trigger creates Talent Flow movement
-- (See talent_flow.create_event_from_enrichment trigger)

-- Movement trigger creates BIT event
-- (See talent_flow.create_bit_event_from_movement trigger)

-- BIT scores view auto-updates
-- (Real-time calculation on query)
```

### Agent Coordination

**Conflict Resolution**: When multiple agents detect same movement
1. Choose highest confidence score
2. Merge payloads (combine data from all sources)
3. Update movement record (keep highest quality)

**Deduplication**: Prevent duplicate movements
```sql
-- Check for existing movement in last 7 days
SELECT 1 FROM talent_flow.movements
WHERE contact_id = :contact_id
  AND movement_type = 'hire'
  AND DATE(detected_at) = :detected_date;
```

**Rate Limiting**: Prevent API overuse
- Apify: 1000 profiles/day max
- Abacus: No limit (webhook-based)
- Firecrawl: 500 URLs/day max

### Monitoring & Alerts

**Grafana Dashboard**: Executive Enrichment Monitoring
- Panel 1: Enrichments per day (target: 100+)
- Panel 2: Success rate (target: 90%+)
- Panel 3: Agent performance comparison
- Panel 4: Movement detection rate (target: 5%+)

**Slack Alerts**:
- Critical: Agent failure (3+ consecutive failures)
- Warning: Low success rate (< 80%)
- Info: Daily summary (enrichments completed)

**Monthly Audit**:
```sql
-- Run compliance check
npm run compliance:complete --module=enrichment
```

---

## Lifecycle Diagram Reference

**Mermaid Diagram**: `/doctrine/diagrams/PLE-Hub-Spoke-Axle.mmd`

Visual representation of:
- Hub (Blue) = Core data lake
- Spokes (Crimson) = Intelligence gathering
- Axle (Gold) = BIT scoring engine
- Wheel Rim (Teal) = Outreach layer

**Usage**:
- View in GitHub (auto-renders Mermaid)
- View in Obsidian (Mermaid plugin required)
- Export to PNG via Mermaid Live Editor

---

## Grafana Panel References

### Dashboard 1: SVG-PLE Overview
**Location**: `https://dbarton.grafana.net/d/svg-ple-dashboard`

**Panels**:
1. **BIT Score Heatmap**: Color-coded company scores (Hot/Warm/Cold)
2. **Score Distribution**: Histogram of intent scores
3. **Hot Companies**: Table of 80-100 score accounts
4. **Signal Types**: Breakdown of event types (last 30 days)

### Dashboard 2: Executive Enrichment Monitoring
**Location**: `https://dbarton.grafana.net/d/executive-enrichment-monitoring`

**Panels**:
1. **Pending Enrichments**: CFO/CEO/HR slots awaiting enrichment
2. **Jobs In Progress**: Currently running enrichment agents
3. **Failed Jobs**: Enrichments with errors (last 7 days)
4. **Agent Performance**: Success rate by agent (Apify, Abacus, Firecrawl)
5. **Timeline**: Enrichments completed over time

### Dashboard 3: Barton Outreach Dashboard
**Location**: `https://dbarton.grafana.net/d/barton-outreach-dashboard`

**Panels**:
1. **Companies by Intent Score**: Pie chart (Hot/Warm/Cold)
2. **Movement Events**: Recent executive hires/departures
3. **Outreach Opportunities**: Companies ready for contact
4. **Response Rates**: Email open/reply rates by score category

**SQL Queries**: `/infra/docs/ENRICHMENT_TRACKING_QUERIES.sql`

---

## Doctrine Cross-Links

### Primary Doctrines (Active)

1. **BIT Doctrine** (`01.04.03.04.10000.001`)
   - File: `/doctrine/ple/BIT-Doctrine.md`
   - Schema: `/doctrine/schemas/bit-schema.sql`
   - Purpose: Intent scoring engine (Axle)
   - Status: âœ… Active

2. **Talent Flow Doctrine** (`01.04.02.04.20000.001`)
   - File: `/doctrine/ple/Talent-Flow-Doctrine.md`
   - Schema: `/doctrine/schemas/talent_flow-schema.sql`
   - Purpose: Movement detection spoke
   - Status: âœ… Active

3. **PLE Master Doctrine** (This Document) (`01.04.01.04.30000.001`)
   - File: `/doctrine/ple/PLE-Doctrine.md`
   - Purpose: System of systems orchestration
   - Status: âœ… Active

### Secondary Doctrines (Planned)

4. **Renewal Intelligence Doctrine** (`01.04.02.04.21000.001`)
   - File: `/doctrine/ple/Renewal-Doctrine.md` (to be created)
   - Purpose: Contract renewal tracking spoke
   - Status: ğŸ“… Planned

5. **Compliance Monitor Doctrine** (`01.04.02.04.22000.001`)
   - File: `/doctrine/ple/Compliance-Doctrine.md` (to be created)
   - Purpose: Regulatory event detection spoke
   - Status: ğŸ“… Planned

### Supporting Documentation

- **Outreach Doctrine Aâ†’Z** (`OUTREACH_DOCTRINE_A_Z_v1.3.2.md`)
  - Complete system documentation
  - Database schema maps
  - Barton ID format reference

- **Global Configuration** (`global-config.yaml`)
  - CTB structure (sys, ai, data, docs, ui, meta)
  - HEIR/ORBT configuration
  - Integration settings (Composio, Firebase, Neon, Grafana)

- **Schema Map** (`docs/schema_map.json`)
  - Complete database schema reference
  - Table relationships
  - Index documentation

- **Enrichment Queries** (`infra/docs/ENRICHMENT_TRACKING_QUERIES.sql`)
  - 10 monitoring queries
  - Grafana panel SQL
  - Audit scripts

---

## Integration with External Tools

### Obsidian

**Setup**: Create vault at `/doctrine/`

**Benefits**:
- Bidirectional linking between doctrines
- Graph view of doctrine relationships
- Mermaid diagram rendering
- Full-text search across all docs

**Example Links**:
```markdown
The [[BIT-Doctrine]] axle receives events from [[Talent-Flow-Doctrine]] spoke.
See the [[PLE-Hub-Spoke-Axle.mmd]] diagram for visual architecture.
```

### GitKraken

**Setup**: Open repo in GitKraken

**Benefits**:
- Visual commit history for doctrine changes
- Branch management for new spoke development
- Merge conflict resolution
- Git blame for doctrine authorship

**Workflow**:
1. Create feature branch: `feature/renewal-spoke`
2. Implement Renewal-Doctrine.md + renewal-schema.sql
3. Commit with message: `feat: add Renewal Intelligence spoke doctrine`
4. Push and create PR
5. Review in GitHub, merge to main

### GitHub Projects

**Setup**: Link to SVG-PLE project board

**Benefits**:
- Track spoke implementation progress
- Link commits to tasks
- Automated status updates (In Progress â†’ Done)

**Example Task**:
- Title: "Implement Renewal Intelligence Spoke"
- Description: Links to Renewal-Doctrine.md, renewal-schema.sql
- Linked Issues: #45, #46, #47
- Status: ğŸ“… Planned â†’ âš™ï¸ In Progress â†’ âœ… Done

---

## Appendix A: PLE Metrics & KPIs

### System Health Metrics

| Metric | Target | Current | Status |
|--------|--------|---------|--------|
| Event detection speed | < 24h | 5-24h | âœ… |
| BIT score accuracy | > 85% | N/A (new) | ğŸ†• |
| Enrichment success rate | > 90% | 92% | âœ… |
| Movement detection rate | > 5% | 7% | âœ… |
| Duplicate event rate | < 1% | 0.2% | âœ… |

### Business Impact Metrics

| Metric | Baseline | Target | Current |
|--------|----------|--------|---------|
| Email response rate | 2-5% | 25-40% | TBD |
| Sales cycle length | 90 days | 60 days | TBD |
| Pipeline value per rep | $500K | $1.2M | TBD |
| Lead qualification time | 30 min | 0 min | TBD |
| Sales rep productivity | 40% | 85% | TBD |

---

## Appendix B: Quick Reference

### Key Components

- **PLE**: Perpetual Lead Engine (master system)
- **Hub**: Core data (companies, people, jobs)
- **Spokes**: Intelligence gathering (Talent Flow, Renewal, Compliance)
- **Axle**: BIT scoring engine
- **Wheel Rim**: Outreach automation

### Barton ID Prefixes

- PLE Master: `01.04.01.04.30000`
- Talent Flow: `01.04.02.04.20000`
- Renewal: `01.04.02.04.21000`
- Compliance: `01.04.02.04.22000`
- BIT: `01.04.03.04.10000`

### Score Categories

- ğŸ”¥ **Hot** (80-100): Immediate outreach
- ğŸ”¶ **Warm** (50-79): Nurture campaign
- ğŸ”µ **Cold** (0-49): Monitor only

### Key Files

- PLE Doctrine: `/doctrine/ple/PLE-Doctrine.md`
- BIT Doctrine: `/doctrine/ple/BIT-Doctrine.md`
- Talent Flow Doctrine: `/doctrine/ple/Talent-Flow-Doctrine.md`
- Mermaid Diagram: `/doctrine/diagrams/PLE-Hub-Spoke-Axle.mmd`
- Doctrine Index: `/doctrine/README.md`

---

## Document History

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0.0 | 2025-11-07 | Barton Outreach Team | Initial PLE Master Doctrine creation |

---

**End of PLE Doctrine**

*For technical implementation, see component doctrines (BIT, Talent Flow)*
*For visual architecture, see `/doctrine/diagrams/PLE-Hub-Spoke-Axle.mmd`*
*For operational procedures, see `/doctrine/README.md`*
