# ============================================
# Enrichment Bridge Configuration
# Supabase Enrichment Hub Destination
# ============================================
#
# This file configures the Enrichment Hub Supabase workspace
# where external records will be received for review and enrichment.
#
# Usage:
#   1. Copy this file and remove .example suffix
#   2. Fill in your Supabase credentials
#   3. Configure schema and table names
#   4. Reference in n8n workflow credentials

# ============================================
# Supabase Connection
# ============================================

# Supabase project URL
SUPABASE_URL="https://your-project.supabase.co"

# Supabase project ID
SUPABASE_PROJECT_ID=""

# Database connection details
SUPABASE_DB_HOST="db.your-project.supabase.co"
SUPABASE_DB_PORT="5432"
SUPABASE_DB_NAME="postgres"
SUPABASE_DB_USER="postgres"
SUPABASE_DB_PASSWORD=""

# Full connection string (alternative to individual params)
SUPABASE_DB_URL="postgresql://postgres:password@db.your-project.supabase.co:5432/postgres?sslmode=require"

# API Keys (for REST API access, if needed)
SUPABASE_ANON_KEY=""
SUPABASE_SERVICE_ROLE_KEY=""

# ============================================
# Destination Schema & Tables
# ============================================

# Schema containing enrichment tables
SUPABASE_SCHEMA="public"

# Destination tables in Enrichment Hub
DEST_TABLE_COMPANY="company_needs_enrichment"
DEST_TABLE_PEOPLE="people_needs_enrichment"

# Optional: additional entity tables
DEST_TABLE_CLIENT="client_needs_enrichment"
DEST_TABLE_VENDOR="vendor_needs_enrichment"

# ============================================
# Default Field Values
# ============================================

# Default validation status for incoming records
DEFAULT_VALIDATION_STATUS="PENDING"

# Default enrichment priority
DEFAULT_PRIORITY="medium"

# Default assigned team/user
DEFAULT_ASSIGNED_TO=""

# ============================================
# Audit Configuration
# ============================================

# Neon database for audit logging
AUDIT_DB_URL="postgresql://user:pass@neon-host/db?sslmode=require"

# Audit table (typically in Neon, not Supabase)
AUDIT_SCHEMA="shq"
AUDIT_TABLE="audit_log"

# Enable detailed audit logging
ENABLE_AUDIT_LOG="true"

# ============================================
# Data Handling
# ============================================

# How to handle duplicate records?
# Options: skip, update, append
DUPLICATE_STRATEGY="skip"

# Field to check for duplicates
DUPLICATE_CHECK_FIELD_COMPANY="domain"
DUPLICATE_CHECK_FIELD_PEOPLE="email"

# Automatically assign batch IDs?
AUTO_BATCH_ID="true"

# Batch ID prefix
BATCH_ID_PREFIX="EXT"

# ============================================
# Validation Rules
# ============================================

# Required fields for company records
REQUIRED_COMPANY_FIELDS="company_name,domain"

# Required fields for people records
REQUIRED_PEOPLE_FIELDS="first_name,last_name,email"

# Auto-validate if all required fields present?
AUTO_VALIDATE="false"

# ============================================
# Enrichment Workflow Settings
# ============================================

# Auto-assign enrichment tasks?
AUTO_ASSIGN_TASKS="false"

# Default enrichment source to try first
DEFAULT_ENRICHMENT_SOURCE="apollo"

# Enable auto-enrichment trigger?
TRIGGER_AUTO_ENRICHMENT="false"

# ============================================
# Notifications
# ============================================

# Enable notifications on new batches?
ENABLE_NOTIFICATIONS="false"

# Notification webhook URL (Slack, Discord, etc.)
NOTIFICATION_WEBHOOK_URL=""

# Notification threshold (minimum records to trigger alert)
NOTIFICATION_THRESHOLD="10"

# ============================================
# Performance & Limits
# ============================================

# Maximum records per batch insert
MAX_BATCH_INSERT="500"

# Retry failed inserts?
RETRY_FAILED_INSERTS="true"

# Max retry attempts
MAX_RETRY_ATTEMPTS="3"

# ============================================
# Security & Compliance
# ============================================

# Encrypt sensitive fields?
ENCRYPT_PII="false"

# Encryption key (if ENCRYPT_PII=true)
ENCRYPTION_KEY=""

# Data retention policy (days)
RETENTION_DAYS="90"

# GDPR compliance mode
GDPR_COMPLIANT="true"

# ============================================
# CTB Integration
# ============================================

# Link to CTB system?
CTB_INTEGRATION="true"

# CTB project ID
CTB_PROJECT_ID="4.svg.marketing.enricha-vision"

# CTB branch for data operations
CTB_BRANCH="ctb/data"

# Auto-tag records with CTB metadata?
CTB_AUTO_TAG="true"

# ============================================
# Example Configuration
# ============================================

# Example: Standard Enrichment Hub setup
# SUPABASE_URL="https://abc123.supabase.co"
# SUPABASE_DB_URL="postgresql://postgres:pass@db.abc123.supabase.co:5432/postgres?sslmode=require"
# SUPABASE_SCHEMA="public"
# DEST_TABLE_COMPANY="company_needs_enrichment"
# DEST_TABLE_PEOPLE="people_needs_enrichment"
# DEFAULT_VALIDATION_STATUS="PENDING"
# DUPLICATE_STRATEGY="skip"
# ENABLE_AUDIT_LOG="true"
# AUDIT_DB_URL="postgresql://user:pass@neon-prod.region.neon.tech/marketing?sslmode=require"

# ============================================
# Notes
# ============================================
# - Keep credentials secure - never commit to git
# - Use .gitignore to exclude this file
# - Supabase credentials can be found in Project Settings > Database
# - For API operations, use service_role_key (never expose in client code)
# - Test connection and permissions before scheduling workflows
# - Ensure tables exist with proper schema before first run
# - Monitor Supabase dashboard for performance and usage limits
