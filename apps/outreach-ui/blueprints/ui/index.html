<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barton Outreach Core</title>
    <meta name="description" content="Outreach management dashboard for Barton Outreach Core">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    <!-- Preconnect to external resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* Base reset and setup */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            color: #1e293b;
            line-height: 1.6;
        }
        
        /* Loading state */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-size: 1.2em;
            color: #667eea;
        }
        
        .loading::after {
            content: '';
            width: 20px;
            height: 20px;
            border: 2px solid #667eea;
            border-top: 2px solid transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Error state */
        .error {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            color: #dc2626;
            text-align: center;
        }
        
        .error h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .error p {
            margin-bottom: 20px;
        }
        
        .error button {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
        }
        
        .error button:hover {
            background: #5a6fd8;
        }
        
        /* Hide app initially */
        #app {
            display: none;
        }
        
        #app.loaded {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Loading state -->
    <div id="loading" class="loading">
        Initializing Barton Outreach Core
    </div>
    
    <!-- Error state -->
    <div id="error" class="error" style="display: none;">
        <h1>‚ö†Ô∏è Error</h1>
        <p id="error-message">Failed to load the application</p>
        <button onclick="window.location.reload()">Reload</button>
    </div>
    
    <!-- Main application -->
    <div id="app" role="main" aria-label="Barton Outreach Core Dashboard">
        <!-- Content will be dynamically generated by app.js -->
    </div>
    
    <!-- Load the main application script -->
    <script src="app.js"></script>
    
    <script>
        // Enhanced error handling and loading states
        window.addEventListener('error', function(e) {
            console.error('Global error:', e.error);
            showError('JavaScript Error: ' + e.message);
        });
        
        window.addEventListener('unhandledrejection', function(e) {
            console.error('Unhandled promise rejection:', e.reason);
            showError('Promise Error: ' + e.reason);
        });
        
        function showError(message) {
            const loading = document.getElementById('loading');
            const error = document.getElementById('error');
            const errorMessage = document.getElementById('error-message');
            
            loading.style.display = 'none';
            errorMessage.textContent = message;
            error.style.display = 'flex';
        }
        
        function hideLoading() {
            const loading = document.getElementById('loading');
            const app = document.getElementById('app');
            
            loading.style.display = 'none';
            app.classList.add('loaded');
        }
        
        // Show app once DOM is ready and scripts are loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Give a small delay to ensure app.js has initialized
            setTimeout(() => {
                if (document.getElementById('app').innerHTML.trim()) {
                    hideLoading();
                } else {
                    // If app hasn't rendered yet, wait a bit more
                    setTimeout(() => {
                        if (document.getElementById('app').innerHTML.trim()) {
                            hideLoading();
                        } else {
                            showError('Application failed to initialize properly');
                        }
                    }, 2000);
                }
            }, 500);
        });
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + R to refresh data
            if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
                e.preventDefault();
                if (typeof refreshData === 'function') {
                    refreshData();
                }
            }
            
            // Esc to clear selection (if any)
            if (e.key === 'Escape') {
                // Could add functionality to clear modals or selections
            }
        });
        
        // Service worker registration for future PWA capabilities
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                // Service worker could be added here for offline capabilities
            });
        }
        
        console.log('üöÄ Barton Outreach Core HTML initialized');
    </script>
</body>
</html>