# Service Catalog (30k Declaration)
# External service registry and dependency management

version: "1.0"
altitude: "30k"
status: "catalog_only"

# Primary External Dependencies
services:
  render_for_db:
    name: "Render Database Interface API"
    type: "database_interface"
    criticality: "high"
    
    deployment:
      platform: "render.com"
      repository: "https://github.com/djb258/Render-for-DB.git"
      environment: "production"
      region: "us-east-1"
      
    connectivity:
      protocol: "https"
      base_url: "${RENDER_API_BASE_URL}"
      port: 443
      timeout_ms: 30000
      
    authentication:
      method: "api_key"
      header: "X-API-Key"
      secret_ref: "RENDER_API_KEY"
      
    capabilities:
      - "database_operations"
      - "company_insertion" 
      - "slot_management"
      - "neon_database_interface"
      
    sla:
      availability: "99.9%"
      response_time_p95: "500ms"
      throughput_rps: "100"
      
    contact:
      team: "data-platform"
      slack: "#data-ops"
      email: "data-platform@company.com"
      
  ingest_companies_people:
    name: "Companies & People Ingester"
    type: "external_processor"
    criticality: "high"
    
    deployment:
      platform: "github_repo"
      repository: "https://github.com/djb258/ingest-companies-people"
      integration: "calls_render_for_db"
      
    capabilities:
      - "apollo_data_processing"
      - "csv_file_processing"
      - "data_normalization"
      - "render_api_integration"
      
    data_sources:
      - "apollo.io"
      - "csv_uploads"
      - "manual_inputs"
      
  neon_database:
    name: "Neon Serverless Database"
    type: "database"
    criticality: "high"
    
    deployment:
      platform: "neon.tech"
      environment: "production"
      region: "us-east-1"
      
    connectivity:
      protocol: "postgresql"
      host: "${NEON_DATABASE_HOST}"
      port: 5432
      database: "${NEON_DATABASE_NAME}"
      ssl_mode: "require"
      
    authentication:
      method: "connection_string"
      secret_ref: "NEON_DATABASE_URL"
      
    capabilities:
      - "company_storage"
      - "slot_management"
      - "ple_tracking"
      - "history_logging"

# Service Dependencies (30k Declarations)
dependency_graph:
  node_1_ple:
    depends_on:
      - service: "ingest_companies_people"
        relationship: "data_processor"
        failure_mode: "retry_with_backoff"
        
      - service: "render_for_db"
        relationship: "database_interface"
        failure_mode: "circuit_breaker"
        
      - service: "neon_database"
        relationship: "data_store"
        failure_mode: "retry_with_backoff"

# Environment Configuration
environments:
  development:
    render_for_db:
      base_url: "https://dev-db-api.render.com"
    ingest_companies_people:
      branch: "develop"
        
  staging:
    render_for_db:
      base_url: "https://staging-db-api.render.com"
    ingest_companies_people:
      branch: "staging"
        
  production:
    render_for_db:
      base_url: "https://db-api.render.com"
    ingest_companies_people:
      branch: "main"

# Monitoring & Observability
monitoring:
  health_checks:
    - service: "render_for_db"
      endpoint: "/health"
      interval_seconds: 30
      timeout_ms: 5000
      
    - service: "neon_database"
      query: "SELECT 1"
      interval_seconds: 60
      timeout_ms: 3000
      
  alerts:
    - name: "render_db_api_down"
      condition: "health_check_failed"
      service: "render_for_db"
      threshold: 3
      action: "page_on_call"
      
    - name: "db_api_high_latency"
      condition: "response_time_p95 > 1000ms"
      service: "render_for_db"
      duration: "5m"
      action: "slack_alert"

# Security Configuration
security:
  secrets_management:
    provider: "environment_variables"
    rotation_policy: "90_days"
    
  network_security:
    - service: "render_for_db"
      requirements: ["https_only", "api_key_auth"]
      
    - service: "neon_database" 
      requirements: ["ssl_required", "connection_string_auth"]
      
  compliance:
    data_classification: "internal"
    retention_policy: "7_years"
    audit_logging: "enabled"

# 30k Implementation Notes
implementation_status: |
  CATALOG ONLY - NO ACTUAL INTEGRATIONS
  
  30k Altitude Constraints:
  - Service definitions are declarations only
  - No actual HTTP clients implemented
  - No authentication logic created
  - No monitoring setup configured
  - No health checks implemented
  - No alert rules deployed
  
  Implementation Timeline:
  - 20k: Basic service integration & authentication
  - 10k: Advanced monitoring & error handling  
  - 5k: Production deployment & operations